WITH LatestEntries AS (
    SELECT 
        ID,
        OBJ_VERSION,
        COLLISION_ID,
        COLL_STATUS_TYPE_ID,
        EFFECTIVE_DATE,
        CSTH_COMMENT,
        CREATED_USER_ID,
        CREATED_TIMESTAMP,
        MODIFIED_USER_ID,
        MODIFIED_TIMESTAMP,
        MODIFIED_FROM_IP_ADDR,
        ROW_NUMBER() OVER (PARTITION BY COLLISION_ID ORDER BY CREATED_TIMESTAMP DESC) AS rn
    FROM 
        ecrdba.cl_status_history
    WHERE 
        COLLISION_ID IN ('2818091', '2818092', '2687022', '2818096', '2818097', '2818099', '2818100', '2818102', '2687031', '2818103', '2818104', '2588750', '2818190', '2818191', '2818192', '2818254', '2818270', '2785522',
'2785523', '2785524', '2785525', '2785527', '2785528', '2818302', '2818303', '2818353', '2818354', '2818355', '2818356', '2818357', '2818359', '2818362', '2818363', '2818365', '2818383', '2818384', '2818415', '2818424', '2818431', '2818437', '2818447', '2818449', '2818451', '2818453', '2818457', '2818458', '2818462', '2818463', '2818465', '2818473', '2818483', '2818507', '2818514', '2818524', '2818525', '2818526', '2818527', '2818528', '2748536', '2785766', '2785788', '2818559', '2818575', '2818576', '2818592', '2785825', '2818593', '2818594', '2818625', '2785870', '2785871', '2785872', '2818643', '2785882', '2785884', '2785885', '2785886', '2785887', '2785888', '2785889', '2818659', '2818660', '2818665', '2818666', '2818667', '2818668', '2818669', '2785902', '2785903', '2818670', '2818671', '2818674', '2818675', '2818673', '2818676', '2818677', '2818678', '2818679', '2818680', '2818681', '2818682', '2818683', '2818686', '2785919', '2818688', '2818689', '2818687', '2785926', '2785927', '2785928', '2785930', '2818706', '2785952', '2785953', '2818723', '2785956', '2785957', '2785958', '2818728', '2818732', '2818736', '2818739', '2753204', '2753205', '2818740', '2818742', '2818743', '2818746', '2785983', '2785985', '2785986', '2785987', '2785988', '2785989', '2785990', '2785991', '2785992', '2785997', '2786002', '2818774', '2818776', '2786018', '2786019', '2786020', '2786021', '2786022', '2786023', '2786030', '2786034', '2786038', '2818807', '2786048', '2786055', '2818823', '2786072', '2786073', '2786074', '2786075', '2786082', '2786083', '2786084', '2786085', '2786089', '2786093', '2786100', '2786101', '2786105', '2786106', '2786107', '2786108', '2786116', '2818884', '2786118', '2786119', '2786120', '2786121', '2786122', '2786141', '2786142', '2786143', '2818910',
'2786145', '2818911', '2818917', '2818919', '2622312', '2818920', '2818921', '2786155', '2786156', '2786157', '2786158', '2818922', '2818925', '2720623', '2786165', '2786166', '2786167', '2786168', '2720636'
)
)
SELECT 
    ID,
    OBJ_VERSION,
    COLLISION_ID,
    COLL_STATUS_TYPE_ID,
    EFFECTIVE_DATE,
    CSTH_COMMENT,
    CREATED_USER_ID,
    CREATED_TIMESTAMP,
    MODIFIED_USER_ID,
    MODIFIED_TIMESTAMP,
    MODIFIED_FROM_IP_ADDR
FROM 
    LatestEntries
WHERE 
    rn = 1 AND COLL_STATUS_TYPE_ID = '220'; -- COLL_STATUS_TYPE_ID = '220' where 220 is "upload pending", since the COLLISION_ID to be tested are assumed to be deleted, any rows shown with this filter is the discrepancy since if a case is in "upload pending" status, it should be in both eCollision and eCollision Analytics